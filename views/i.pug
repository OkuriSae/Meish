extends layout/layout

block meta

  meta(property="og:type" content="article")
  meta(property="og:site_name" content="Meish*")
  meta(property="og:title" content=`${personality.nameJa} | ${personality.label}`)
  meta(property="og:description" content=personality.introduction.slice(0,200))
  meta(property="og:url" content="http://www.meish.me/i/"+owner.username)
  if personality.ogp_path
    meta(property="og:image" content=`${personality.ogp_path}`)
  else
    meta(property="og:image" content='https://meish.s3-ap-northeast-1.amazonaws.com/meish_logo_ogp.png')
  meta(name="twitter:card" content="summary_large_image")
  meta(name="twitter:site" content="@"+owner.username)

  link(rel="stylesheet" href="/css/i/i.css")
  if !(mode == "edit")
    link(rel="stylesheet" href="/css/i/notme.css")

block content
  // èƒŒæ™¯ã‚’å›ºå®šåŒ–ã™ã‚‹CSSï¼ˆã‚¹ãƒãƒ›ã§èƒŒæ™¯æµã‚Œã¡ã‚ƒã†å¯¾ç­–ï¼‰
  - var back = personality.logo_path ? personality.logo_path : '/img/logos/meish_logo_back.png'
  style(type="text/css").
    body::before{
      content: '';
      display:block;
      position:fixed;
      top:0;
      left:0;
      z-index:-1;
      width:100%;
      height: 100vh;
      background:url(#{back});
      background-position:  center center;
      background-repeat: no-repeat;
      background-size: contain;
      -webkit-background-size: contain;
      filter: opacity(50%);
    }
  section(style="border-top: solid 1px; padding-bottom:80px;").page-section.bg-gray
    div.profile.container.justify-content-center.rounded
      // æ“ä½œãƒ‘ãƒãƒ«
      if isMe 
        if mode == "edit" && (!personality.ogp_path || !personality.thumbnail_path || !visibility)
          div(style="width:100%; background-color: #F6F6F6; border-radius:10px; padding: 10px;").my-3
            ul(style="margin: 0;")
              if !personality.ogp_path
                li 
                  span
                    a(href="https://www.google.com/search?q=OGP" target="_blank").text-danger  OGPã‚¤ãƒ¡ãƒ¼ã‚¸
                  span.text-dark ï¼ˆURLå±•é–‹ç”¨ã®ç”»åƒï¼‰ãŒã‚ã‚Šã¾ã›ã‚“ 
                  span(data-toggle="modal" data-target="#OgpModal" style="cursor: pointer;").text-info â‰«è¨­å®šã™ã‚‹
              if !personality.thumbnail_path
                li 
                  span.text-danger æ¤œç´¢ç”¨ã‚µãƒ ãƒã‚¤ãƒ«
                  span.text-dark  ãŒã‚ã‚Šã¾ã›ã‚“ï¼ˆTOPç”»é¢ã‚„æ¤œç´¢çµæœã«è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ï¼‰
                  span(data-toggle="modal" data-target="#TachieModal" style="cursor: pointer;").text-info â‰«è¨­å®šã™ã‚‹
              if !visibility
                li ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã¯
                  span.text-danger  éå…¬é–‹çŠ¶æ…‹ 
                  span ã§ã™ 

        p
          div.d-flex.flex-wrap
            div.ml-2.mt-2
              // å…¬é–‹/éå…¬é–‹
              form(method='post' action='/i/'+me.username+'/visibility' id="VisibilityForm" style="display: inline-flex;").edit
                input(type="hidden" name="visibility" value=visibility)
                input(type="hidden" name="_csrf" value=csrfToken)
                if visibility
                  button.btn-sm.btn-outline-danger
                    i.fas.fa-stop  éå…¬é–‹ã«ã™ã‚‹
                else
                  button.btn-sm.btn-outline-info 
                    i.fas.fa-play  å…¬é–‹ã™ã‚‹
            
            div.ml-2.mt-2
              // ç·¨é›†/ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
              if mode == "edit"
                a#viewLink
                  button.btn-sm.btn-outline-success
                    i.fas.fa-eye  é–²è¦§ãƒ¢ãƒ¼ãƒ‰ã«ã™ã‚‹
              else
                a#editLink
                  button.btn-sm.btn-outline-info
                    i.fas.fa-pen  ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã«ã™ã‚‹

            div.ml-2.mt-2
              // ä½¿ã„æ–¹
              a(href="/howto" target="_blank")
                button.btn-sm.btn-outline-secondary
                  i.fas.fa-question-circle  ä½¿ã„ã‹ãŸ

            // Tweetãƒœã‚¿ãƒ³
            div(style="position: relative; top:1px;").ml-2.mt-2
              a(href="https://twitter.com/share" class="twitter-share-button"
                data-url="http://www.meish.me/i/"+owner.username
                data-text=personality.nameJa+"ã®ãƒãƒ¼ãƒãƒ£ãƒ«ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ« / Meish*ï¼ˆÎ²ãƒ†ã‚¹ãƒˆä¸­ã«ã¤ãURLå…¬é–‹NGğŸ™…â€â™€ï¸ï¼‰"
                data-lang="ja"
                data-hashtags="Meish"
                data-size="large"
              ) ãƒ„ã‚¤ãƒ¼ãƒˆ
              script(async src="https://platform.twitter.com/widgets.js" charset="utf-8")


      // èƒŒæ™¯ç”»åƒ
      - var backImage = personality.back_path ? `background-image:url(${personality.back_path}); background-size: cover; background-position:center;border-radius:8px;` : "";
      div(style=backImage).profileImage.row.m-0
        // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒ
        - var backImage = personality.tachie ? `background-image:url(${personality.tachie}); border-radius:0px;` : "";
        div(style=backImage+"width:100%; margin:0;").profileImage.row
          if personality.tachie
            input(type="hidden" value=personality.tachie)#tachieSource
          div(style="width:550px; max-width:100%;").personalities.py-2
            div

              // ç·¨é›†ãƒœã‚¿ãƒ³
              div.m-3.text-right
                i(data-toggle="modal" data-target="#BasicInfoModal" style="cursor: pointer; font-size: 1.6rem;").fas.fa-pen.text-info.edit
              
              div(style="margin-top:.83rem;").mx-2.my-3
                // ã‚ˆã¿
                div(style="font-size: 1.2rem;").text-secondary.shadow-gray.mx-1.nameEn #{personality.nameEn}
                // åå‰
                div(style="font-size: 2.5rem; line-height:1.2;").name 
                  b #{personality.nameJa}
              // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æœ¬æ–‡
              hr.profHR
              h5.m-2.text-secondary.shadow-gray
                span #{personality.label}
              p(style="white-space:pre-wrap;").shadow-gray.m-2 #{personality.introduction}
              hr.profHR

            // ã‚«ãƒ†ã‚´ãƒªæƒ…å ±
            .container.m-2.shadow-gray
              .row
                mixin categorizedInfo(title, name)

                  div(style="min-width:250px;").mt-2
                    div(style=" margin-bottom: 0.5rem;").d-flex.align-items-center
                      h3.category #{title}
                        small
                          i(data-toggle="modal" data-target="#"+name+"Modal" style="cursor: pointer;").mx-2.fas.fa-pen.text-info.edit
                    div
                      block

                - var serviceIcons = {}
                - serviceIcons["twitter.com"] = "twitter_icon.png"
                - serviceIcons["mobile.twitter.com"] = "twitter_icon.png"
                - serviceIcons["www.youtube.com"] = "youtube_icon.png"
                - serviceIcons["m.youtube.com"] = "youtube_icon.png"
                - serviceIcons["youtu.be"] = "youtube_icon.png"
                - serviceIcons["marshmallow-qa.com"] = "marshmallow_icon.png"
                - serviceIcons["coconala.com"] = "coconala_icon.jpg"
                - serviceIcons["17.live"] = "17.live_icon.png"
                - serviceIcons["com.nicovideo.jp"] = "niconico_icon.png"
                - serviceIcons["www.nicovideo.jp"] = "niconico_icon.png"
                - serviceIcons["nico.ms"] = "niconico_icon.png"
                - serviceIcons["discord.gg"] = "discord_icon.png"
                - serviceIcons["nana-music.com"] = "nana_icon.png"
                - serviceIcons["note.com"] = "note_icon.png"
                - serviceIcons["skeb.jp"] = "skeb_icon.png"
                - serviceIcons["space.bilibili.com"] = "bilibili_icon.png"
                - serviceIcons["twitcasting.tv"] = "twitcasting_icon.png"
                - serviceIcons["web.iriam.app"] = "iriam_icon.jpg"
                - serviceIcons["www.instagram.com"] = "instagram_icon.png"
                - serviceIcons["www.mirrativ.com"] = "mirrativ_icon.png"
                - serviceIcons["www.openrec.tv"] = "openrec_icon.png"
                - serviceIcons["www.pixiv.net"] = "pixiv_icon.png"
                - serviceIcons["www.pixiv.net/fanbox"] = "pixiv_icon.png"
                - serviceIcons["www.showroom-live.com"] = "showroom_icon.png"
                - serviceIcons["www.twitch.tv"] = "twitch_icon.png"
                - serviceIcons["www.vrchat.com"] = "vrchat_icon.png"
                - serviceIcons["github.com"] = "github_icon.png"
                - serviceIcons["www.mildom.com"] = "mildom_icon.png"
                - serviceIcons["steamcommunity.com"] = "steam_icon.png"
                - serviceIcons["soundcloud.com"] = "soundcloud_icon.png"
                - serviceIcons["www.amazon.co.jp"] = "amazon_icon.png"
                - serviceIcons["www.amazon.jp"] = "amazon_icon.png"
                - serviceIcons["giftee.co"] = "giftee_icon.png"
                - serviceIcons["store.line.me"] = "line_icon.png"
                - serviceIcons["line.me"] = "line_icon.png"
                - serviceIcons["topia.tv"] = "topia_icon.jpg"
                - serviceIcons["user.topia.tv"] = "topia_icon.jpg"
                - serviceIcons["virtual-youtuber.userlocal.jp"] = "userlocal_icon.jpeg"
                - serviceIcons["vtuber-post.com"] = "vpos_icon.jpg"
                - serviceIcons["profile.coconala.com"] = "coconala_icon.jpg"
                - serviceIcons["vtubers.love"] = "vtubers_icon.png"
                  
                // ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°
                if hashTags.length > 0 || (isMe && mode == "edit")
                  +categorizedInfo('ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°', 'HashTag')
                    each tag in hashTags
                      p.mx-2
                        b
                          a(href="https://twitter.com/hashtag/"+tag.name target="_blank").no-shadow ##{tag.name}
                        if tag.comment
                          span.text-secondary  - #{tag.comment}

                // æ´»å‹•å ´æ‰€
                if activities.length > 0 || (isMe && mode == "edit")
                  +categorizedInfo('æ´»å‹•å ´æ‰€', 'Activity')
                    each activity in activities
                      p.mx-2
                        if activity.link
                          b
                            a(href=activity.link target="_blank").no-shadow
                              - serviceIcon = serviceIcons[activity.link.split('/')[2]]
                              - serviceIcon = activity.link.match('booth') ? "booth_icon.png" : serviceIcon
                              - serviceIcon = activity.link.match('fanbox') ? "fanbox_icon.jpg" : serviceIcon
                              - serviceIcon = serviceIcon ? serviceIcon : "meish_icon.png"
                              img(src="/img/i/serviceIcons/"+serviceIcon style="width:22px;padding-bottom:4px;")
                              span.mx-2 #{activity.name}
                        else
                          span #{activity.name}

                // å¿œæ´æ–¹æ³•
                if cheerings.length > 0 || (isMe && mode == "edit")
                  +categorizedInfo('å¿œæ´ã™ã‚‹', 'Cheering')
                    each cheer in cheerings
                      p.mx-2 
                        if cheer.link
                          b
                            a(href=cheer.link target="_blank").no-shadow
                              - serviceIcon = serviceIcons[cheer.link.split('/')[2]]
                              - serviceIcon = cheer.link.match('booth') ? "booth_icon.png" : serviceIcon
                              - serviceIcon = cheer.link.match('fanbox') ? "fanbox_icon.jpg" : serviceIcon
                              - serviceIcon = serviceIcon ? serviceIcon : "meish_icon.png"
                              img(src="/img/i/serviceIcons/"+serviceIcon style="width:22px;padding-bottom:4px;")
                              span.mx-2 #{cheer.name}
                        else
                          span #{cheer.name}
            
            // æ¤œç´¢ã‚¿ã‚°
            div(style="text-shadow: none;")
              h5
                p
                  each tag in tags
                    - var tagLink = "/search?query=" + tag.tagname
                    - var tagHue = tag.tagname.charCodeAt(0) % 36 * 10;
                    - var tagText = tag.tagname
                    a(href=tagLink)
                      span(style="background-color:hsl("+tagHue+", 50%, 45%);").badge.badge-secondary.p-2.m-1 #{tagText}
                  // ç·¨é›†ãƒœã‚¿ãƒ³
                  i(data-toggle="modal" data-target="#BasicInfoModal" style="position:relative; top:3px; cursor: pointer; font-size: 1.4rem;").m-1.fas.fa-pen.text-info.edit
              div.edit.mx-1.mb-2
                a(href="/tag_suggest" target="_blank") äººæ°—ã‚¿ã‚°ã‚’è¦‹ã‚‹

      // ãƒãƒ/ãƒ‘ãƒ‘ï¼ˆã‚­ãƒ£ãƒ©çµµå³ä¸‹ï¼‰
      .text-right
        if parents.length != 0
          each parent in parents
            div
              - var parentDisplay = parent.relationship ? `${parent.relationship}: ${parent.name}` : parent.name
              if parent.link
                a(href=parent.link) #{parentDisplay}
              else
                span #{parentDisplay}
        else
          h5.edit é–¢ä¿‚è€…ãƒ»å”åŠ›è€…
        i(data-toggle="modal" data-target="#ParentModal" style="cursor: pointer;").fas.fa-pen.text-info.edit

  // ã‚µãƒ–ã‚»ã‚¯ã‚·ãƒ§ãƒ³é››å½¢
  mixin subSection(title,bg)
    section(class=bg)#about.page-section
      div(style="max-width:100%;").container
        .text-center
          if title
            h1 #{title}
            hr.divider.my-4
          block

  // ç«‹ã¡çµµ
  if tachies.length > 0 || (isMe && mode == "edit")
    // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
    +subSection('ç«‹ã¡çµµ')
      .d-flex.flex-wrap
          // åˆæœŸè¡¨ç¤º
          - tachiesView = tachies.length != 0 ? tachies : [{path: '/img/i/add.png', name: 'Title', comment: '', updatedAt: new Date()}]
          each tachie in tachiesView
            .col-sm.mx-auto.m-2
              .tachie.card
                // ç”»åƒ
                img(src=`${tachie.path}` style="" data-toggle="modal" data-target="#TachieModal").tachie.card-img-top
                if tachie.name || tachie.comment
                  div(style="background-color:rgba(255,255,255,1.00);").card-body
                    // ã‚¿ã‚¤ãƒˆãƒ«ã€ã‚³ãƒ¡ãƒ³ãƒˆ
                    h5.card-title #{tachie.name}
                    p.card-text #{tachie.comment}

  // ã‚­ãƒ£ãƒ©ãƒ‡ã‚¶
  if personality.design_path || (isMe && mode == "edit")
    +subSection('ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ‡ã‚¶ã‚¤ãƒ³', 'bg-white')
        if isMe && mode == "edit"
          p.text-secondary ä¸‰é¢å›³ãªã©ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®ãƒ‡ã‚£ãƒ†ã‚£ãƒ¼ãƒ«ãŒã‚ã‹ã‚‹ç”»åƒã‚’è¨­å®šã—ã¾ã™
        .row.justify-content-center
          .card
            - var design_path = personality.design_path ? personality.design_path : "/img/i/add.png";
            - var description = personality.design_path ? personality.design_comment : "ã‚­ãƒ£ãƒ©ãƒ‡ã‚¶ã®è©³ç´°ã¨ã‹æ›¸ã‘ã¾ã™";
            div.rounded.img-fluid.card-img-top
              img(src=`${design_path}` style="max-width:100%; max-height:500px;" data-toggle="modal" data-target="#DesignModal")
            if description
              .card-body
                p(style="white-space:pre-wrap;").card-text #{description}

  // ç´¹ä»‹å‹•ç”»
  if personality.movie_id || (isMe && mode == "edit")
    +subSection('ç´¹ä»‹å‹•ç”»')
      if isMe && mode == "edit"
        p.text-secondary YouTubeã®ã¿å¯¾å¿œ
        button(data-toggle="modal" data-target="#MovieModal").btn.btn-info.m-3 å‹•ç”»URLã‚’å…¥åŠ›
      if personality.movie_id
        div(style="width:90%; max-width:640px;").mx-auto.m-4
          .youtube-inner
            iframe(width="640" height="360" src="https://www.youtube.com/embed/"+personality.movie_id frameborder="0" allow="autoplay; encrypted-media" allowfullscreen).mx-auto

  // ãƒ­ã‚´/èƒŒæ™¯
  if isMe && mode == "edit"
    div.edit
      +subSection('ãƒ­ã‚´/èƒŒæ™¯', 'bg-white')
        p.text-secondary ãƒšãƒ¼ã‚¸èƒŒæ™¯ã«è¡¨ç¤ºã•ã‚Œã¾ã™
          br
          | ã‚¤ãƒ¡ãƒ¼ã‚¸ç”»åƒã‚„ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ­ã‚´ã‚’è¨­å®šã—ã¦ãã ã•ã„
        .row.justify-content-center
          - var logoPath = personality.logo_path ? personality.logo_path : "/img/i/add.png";
            .card
              div.rounded.img-fluid.card-img-top
                img(src=`${logoPath}` style="width:auto;max-height:400px;" data-toggle="modal" data-target="#LogoModal").rounded.img-fluid

  // OGPç”»åƒ
  if isMe && mode == "edit"
    div.edit
      +subSection('OGPã‚¤ãƒ¡ãƒ¼ã‚¸')
        p.text-secondary Twitterãªã©ã«URLã‚’è²¼ã‚Šä»˜ã‘ãŸæ™‚ã®ç”»åƒå±•é–‹ã§è¡¨ç¤ºã•ã‚Œã¾ã™
          - var ogpPath = personality.ogp_path ? personality.ogp_path : "/img/i/add.png";
          div(style="max-width:600px;").card.mx-auto
            div.rounded.img-fluid.card-img-top
              img(src=`${ogpPath}` style="max-height:400px; width:100%" data-toggle="modal" data-target="#OgpModal").rounded.img-fluid

  // ã‚µãƒ ãƒã‚¤ãƒ«
  if isMe && mode == "edit"
    div.edit
      +subSection('æ¤œç´¢ã‚µãƒ ãƒã‚¤ãƒ«', 'bg-white')
        p.text-secondary æ¤œç´¢ãƒšãƒ¼ã‚¸ã§è¡¨ç¤ºã•ã‚Œã¾ã™
          br
          small ï¼ˆç«‹ã¡çµµç™»éŒ²æ™‚ã«è¨­å®šã§ãã¾ã™ï¼‰
        div(style=`border: solid 1px lightgray; border-radius: .25rem; width: 200px; height: 350px; background-image: url(${personality.thumbnail_path}); background-size: contain; background-position:center; background-repeat: no-repeat; background-color: rgba(255,255,255,0.5); margin:auto;`).img-fluid

  if isMe && mode == "edit"
    // ãƒ¢ãƒ¼ãƒ€ãƒ«é››å½¢
    mixin modal(modalParams)
      div(style="max-width:100%;" tabindex="-1" role="dialog" aria-labelledby=modalParams.name+"ModalLabel" aria-hidden="true" id=modalParams.name+"Modal").modal.fade
        div(role="document").modal-dialog
          .modal-content
            - var actionString = `/i/${me.username+modalParams.action}?_csrf=${csrfToken}`; 
            form(method='post' action=actionString enctype=modalParams.enctype id=modalParams.name+"Form")
              .modal-header
                h5(id=modalParams.name+"ModalLabel").modal-title #{modalParams.title}
                button.close(type="button" data-dismiss="modal" aria-label="Close")
                  span(aria-hidden="true") &times;
              .modal-body
                input(type="hidden" name="deleted" value="0" id=modalParams.name+"Deleted")
                if block
                  block
              .modal-footer
                button(type="button" id=modalParams.name+"DeleteBtn").btn.btn-danger å‰Šé™¤
                button(type="button" data-dismiss="modal").btn.btn-secondary ã‚­ãƒ£ãƒ³ã‚»ãƒ«
                button(type="button" id=modalParams.name+"SubmitBtn").btn.btn-primary æ›´æ–°

    // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒ¢ãƒ¼ãƒ€ãƒ«
    +modal({name: 'BasicInfo', action: '/basicinfo', title: 'åŸºæœ¬ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«', enctype: "multipart/form-data"})
      .form-group.text-center
        #ProfileImage
      
          // æ—¢å­˜ã®ç”»åƒ
          - var backSample = personality.back_path ? personality.back_path : "/img/i/nobackimage.jpg";
          div(style=`background-image: url('${backSample}'); background-size: cover; border-radius:10px;width:75%;margin:auto;`).backImagePreview.imagePreview
            - var tachieSample = personality.tachie ? `background-image: url('${personality.tachie}'); background-position: bottom right;` : `background-image: url('/img/i/noTachie.png'); background-position: bottom right;`;
            div(style=tachieSample).profileImagePreview.imagePreview
         
          div
            // èƒŒæ™¯ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«Input
            label.input-group-btn.m-2
              span.btn.btn-primary èƒŒæ™¯ç”»åƒã‚’é¸æŠ
                input(type="file" name="back" accept="image/jpeg, image/png" style="display:none;")#BackImageFileInput.form-control.my-2
            // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«Input
            label.input-group-btn.m-2
              span.btn.btn-primary ç«‹ã¡çµµã‚’é¸æŠ
                input(type="file" name="tachie" accept="image/jpeg, image/png" style="display:none;")#ProfileImageFileInput.form-control.my-2
        
          .text-secondary.mb-2
            small èƒŒæ™¯: 2MBä»¥ä¸‹, 1920x1080pxä»¥ä¸Š, æ¨ªé•·jpgæ¨å¥¨
              br
              span ç«‹ã¡çµµ: 2MBä»¥ä¸‹, é«˜ã•1080pxä»¥ä¸Š, ç¸¦é•·é€épngæ¨å¥¨

          // ã‚¢ã‚¹æ¯”ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼
          div.d-flex.justify-content-center
            div(style="width:100px;").text-right
              span ã‚¹ãƒãƒ›è¡¨ç¤º
            input(type="range" id="aspectRatioRange" style="width:50%;" min="18" max="72" oninput="$('.backImagePreview').css('width', $('#aspectRatioRange').val()+'%');").custom-range.mx-2
            div(style="width:100px;").text-left
              span PCè¡¨ç¤º

        if personality.back_path || personality.tachie
          .align-middle.form-check
            input(type="checkbox" name="imageClear" onchange="$('#ProfileImage').toggle();")#ProfileImageClearCheck.form-check-input.my-2
            label(for="ProfileImageClearCheck").form-check-label ç”»åƒã‚’ã‚¯ãƒªã‚¢

        input(type="text" placeholder="ã‚ˆã¿ [50æ–‡å­—ã¾ã§]" value=personality.nameEn name="nameEn" maxlength="50").form-control.my-2
        input(type="text" placeholder="åå‰ [50æ–‡å­—ã¾ã§]" value=personality.nameJa name="nameJa" maxlength="50").form-control.my-2
        input(type="text" placeholder="æ¨ã—ãƒã€è‚©æ›¸ãï¼ˆã€‡ã€‡ç³»VTuberï¼‰ã€æ‰€å±ãªã© [50æ–‡å­—ã¾ã§]" maxlength="50" value=personality.label name="label").form-control.my-2
        textarea(placeholder="è‡ªå·±ç´¹ä»‹ [500æ–‡å­—ã¾ã§]" rows="6" name="introduction" maxlength="500").form-control.my-2
          | #{personality.introduction}
        - var tagtext = tags.map((tag) => { return tag.tagname }).join(' ');
        textarea(placeholder="æ¤œç´¢ã‚¿ã‚°ï¼ˆã‚¹ãƒšãƒ¼ã‚¹åŒºåˆ‡ã‚Šï¼‰[åˆè¨ˆ100æ–‡å­—ã¾ã§]" rows="2" name="tags" maxlength="100").form-control.my-2
          | #{tagtext}
        .align-middle.form-check
          input(type="checkbox" name="isSensitive" checked=(personality.isSensitive == 'on'))#sensitiveCheck.form-check-input.my-2
          label(for="sensitiveCheck").form-check-label 
            small ã“ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã«ã¯ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãªè¡¨ç¾ãŒå«ã¾ã‚Œã‚‹

    // ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°ãƒ¢ãƒ¼ãƒ€ãƒ«
    +modal({name: 'HashTag', action: '/hashtag', title: 'ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°', enctype: "application/x-www-form-urlencoded"})
      .form-group
        select(name="target")#HashTagSelection.form-control
          option(value="new" selected) æ–°è¦è¿½åŠ 
            each hashTag in hashTags
              option(value=hashTag.tagId) #{hashTag.name}
        each hashTag in hashTags
          input(type="hidden" class=hashTag.tagId name=hashTag.name comment=hashTag.comment).hashTagHidden
        input(type="text" placeholder="ã‚¿ã‚°åï¼ˆ#ã¯è‡ªå‹•ã§ã¤ãã¾ã™ï¼‰[20æ–‡å­—ã¾ã§]" name="name" maxlength="20")#HashTagNameForm.form-control.my-2
        input(type="text" placeholder="ã‚¿ã‚°ã®èª¬æ˜ [20æ–‡å­—ã¾ã§]" name="comment" maxlength="20")#HashTagCommentForm.form-control.my-2

    // æ´»å‹•å ´æ‰€ãƒ¢ãƒ¼ãƒ€ãƒ«
    +modal({name: 'Activity', action: '/activity', title: 'æ´»å‹•å ´æ‰€', enctype: "application/x-www-form-urlencoded"})
      .form-group
        select(name="target")#ActivitySelection.form-control
          option(value="new" selected) æ–°è¦è¿½åŠ 
          each activity in activities
            option(value=activity.activityId) #{activity.name}
        each activity in activities
          input(type="hidden" class=activity.activityId name=activity.name link=activity.link).activityHidden
        input(type="text" placeholder="è¡¨ç¤ºå [20æ–‡å­—ã¾ã§]" name="name" maxlength="20")#ActivityNameForm.form-control.my-2
        input(type="text" placeholder="URL [200æ–‡å­—ã¾ã§]" name="link" maxlength="200")#ActivityLinkForm.form-control.my-2

    // å¿œæ´æ–¹æ³•ãƒ¢ãƒ¼ãƒ€ãƒ«
    +modal({name: 'Cheering', action: '/cheering', title: 'å¿œæ´æ–¹æ³•', enctype: "application/x-www-form-urlencoded"})
      .form-group
        select(name="target")#CheeringSelection.form-control
          option(value="new" selected) æ–°è¦è¿½åŠ 
          each cheering in cheerings
            option(value=cheering.cheeringId) #{cheering.name}
        each cheering in cheerings
          input(type="hidden" class=cheering.cheeringId name=cheering.name link=cheering.link).cheeringHidden
        input(type="text" placeholder="è¡¨ç¤ºå [20æ–‡å­—ã¾ã§]" name="name" maxlength="20")#CheeringNameForm.form-control.my-2
        input(type="text" placeholder="URL [200æ–‡å­—ã¾ã§]" name="link" maxlength="200")#CheeringLinkForm.form-control.my-2

    // ãƒãƒ/ãƒ‘ãƒ‘ãƒ¢ãƒ¼ãƒ€ãƒ«
    +modal({name: 'Parent', action: '/parent', title: 'ãƒãƒ/ãƒ‘ãƒ‘', enctype: "application/x-www-form-urlencoded"})
      .form-group
        select(name="target")#ParentSelection.form-control
          option(value="new" selected) æ–°è¦è¿½åŠ 
          each parent in parents
            option(value=parent.parentId) #{parent.name}
        each parent in parents
          input(type="hidden" class=parent.parentId name=parent.name relationship=parent.relationship link=parent.link).parentHidden
        input(type="text" placeholder="é–¢ä¿‚ [20æ–‡å­—ã¾ã§]" name="relationship" maxlength="20")#ParentRelationshipForm.form-control.my-2
        input(type="text" placeholder="åå‰ [20æ–‡å­—ã¾ã§]" name="name" maxlength="20")#ParentNameForm.form-control.my-2
        input(type="text" placeholder="URL [200æ–‡å­—ã¾ã§]" name="link" maxlength="200")#ParentLinkForm.form-control.my-2

    // ç«‹ã¡çµµãƒ¢ãƒ¼ãƒ€ãƒ«
    +modal({name: 'Tachie', action: '/tachie', title: 'ç«‹ã¡çµµ', enctype: "multipart/form-data"})
      .form-group.text-center.m-0
        // å¯¾è±¡
        select(name="target")#TachieSelection.form-control.my-2
          if tachies.length < 5
            option(value="new" selected) æ–°è¦è¿½åŠ 
          else 
            option(value="max" selected) - (ç«‹ã¡çµµã¯5æšã¾ã§ã§ã™)
          if tachies.length > 0
            each tachie in tachies
              option(value=tachie.tachieId).tachie #{tachie.name}
        // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
        div(style="display:none;").tachie.imagePreview.upload
        each tachie in tachies
          div(class=tachie.tachieId style=`background-image: url('${tachie.path}'); display:none;`).tachie.imagePreview
        // ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ
        label.input-group-btn.m-2
          span.btn.btn-primary ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ
            input(type="file" name="img" style="display:none" accept="image/jpeg, image/png" required)#TachieFileInput.form-control.my-2
        // æ¤œç´¢ã‚µãƒ ãƒã«ã™ã‚‹
        div(style="display:none;")#ThumbnailCheckForm.align-middle.form-check
          input(type="checkbox" name="useThumbnail")#ThumbnailCheck.form-check-input.my-2
          label(for="ThumbnailCheck").form-check-label æ¤œç´¢ã‚µãƒ ãƒã«ã™ã‚‹
        // ã‚¿ã‚¤ãƒˆãƒ«ã€èª¬æ˜
        each tachie in tachies
          input(type="hidden" class=tachie.tachieId value=tachie.name).tachieNameHidden
          input(type="hidden" class=tachie.tachieId value=tachie.comment).tachieCommentHidden
        input(type="text" placeholder="ã‚¿ã‚¤ãƒˆãƒ« [20æ–‡å­—ã¾ã§]" name="name" maxlength="20").tachieNameForm.form-control.my-2
        input(type="text" placeholder="ã‚³ãƒ¡ãƒ³ãƒˆ [60æ–‡å­—ã¾ã§]" name="comment" maxlength="60").tachieCommentForm.form-control.my-2
        .text-secondary
          small 2MBä»¥ä¸‹, jpg/png, 300x600pxä»¥ä¸Šæ¨å¥¨, 5æšã¾ã§

    // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ¢ãƒ¼ãƒ€ãƒ«
    +modal({name: 'Design', action: '/design', title: 'ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ‡ã‚¶ã‚¤ãƒ³', enctype: "multipart/form-data"})
      .form-group.text-center.m-0
        div(style="display:none;").design.upload.imagePreview
        - var designSample = personality.design_path ? personality.design_path : "/img/i/noimage.jpg";
        div(style=`background-image: url('${designSample}');`).design.imagePreview
        label.input-group-btn.m-2
          span.btn.btn-primary ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ
            input(type="file" name="img" style="display:none" accept="image/jpeg, image/png" required)#DesignFileInput.form-control.my-2
        textarea(placeholder="ã‚³ãƒ¡ãƒ³ãƒˆ [200æ–‡å­—ã¾ã§]" rows="4" name="comment" maxlength="200").form-control.my-2
          | #{personality.design_comment}
        .text-secondary
          small 2MBä»¥ä¸‹, 1920x1080pxä»¥ä¸‹-jpgæ¨å¥¨

    // å‹•ç”»ãƒ¢ãƒ¼ãƒ€ãƒ«
    +modal({name: 'Movie', action: '/movie', title: 'å‹•ç”»'})
      .form-group.text-center.m-0
        input(type="text" placeholder="YouTubeã®URL/ID" name="movie_url" value=personality.movie_id maxlength="100")#MovieUrlForm.form-control.my-2
        .text-secondary
          small ä»¥ä¸‹ã®å½¢å¼ã§å…¥åŠ›ã§ãã¾ã™
            br
            | https://youtu.be/M0UzJSQ8jJ8
            br
            | https://www.youtube.com/watch?v=EnoiwXBRDnI
            br 
            | https://www.youtube.com/embed/-S9j9S9xMe4

    // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ­ã‚´ãƒ¢ãƒ¼ãƒ€ãƒ«
    +modal({name: 'Logo', action: '/logo', title: 'ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ­ã‚´', enctype: "multipart/form-data"})
      .form-group.text-center.m-0
        div(style="display:none;").logo.upload.imagePreview
        - var logoSample = personality.logo_path ? personality.logo_path : "/img/i/noimage.jpg";
        div(style=`background-image: url('${logoSample}');`).logo.imagePreview
        label.input-group-btn.m-2
          span.btn.btn-primary ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ
            input(type="file" name="img" style="display:none" accept="image/jpeg, image/png" required)#LogoFileInput.form-control.my-2
        .text-secondary
          small 2MBä»¥ä¸‹, 1920x1080px-jpgæ¨å¥¨

    // OGPãƒ¢ãƒ¼ãƒ€ãƒ«
    +modal({name: 'Ogp', action: '/ogp', title: 'OGPç”»åƒ', enctype: "multipart/form-data"})
      .form-group.text-center.m-0
        div(style="display:none; background-size: cover; width:400px; height:210px;margin:auto;border-radius:.25rem;").ogp.upload.imagePreview
        - var ogpSample = personality.ogp_path ? personality.ogp_path : "/img/i/noimage.jpg";
        div(style=`background-image: url('${ogpSample}'); background-size: cover; width:400px; height:210px;margin:auto;border-radius:.25rem;`).ogp.imagePreview
        label.input-group-btn.m-2
          span.btn.btn-primary ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ
            input(type="file" name="img" style="display:none" accept="image/jpeg, image/png" required)#OgpFileInput.form-control.my-2
        .text-secondary
          small 2MBä»¥ä¸‹, jpgæ¨å¥¨, 1200x630ã«æ‹¡å¤§/ç¸®å°ã•ã‚Œã¾ã™
          br
          small å³ä¸‹ã«ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒãƒ¼ã‚¯ï¼ˆMeishã®ãƒ­ã‚´ãŒå…¥ã‚Šã¾ã™ï¼‰

  // ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå‰Šé™¤
  if isMe && mode == "edit"
    section(class=bg)#about.page-section.bg-secondary
      .container
        .row.justify-content-center
          .text-center
            form(method='post' action='/i/'+me.username+'/destroy' id="DestroyForm" style="display: inline-flex;").edit.mx-2
              input(type="hidden" name="_csrf" value=csrfToken)
              button(type="submit" onclick="return confirm('æœ¬å½“ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')").btn-sm.btn-danger ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’å‰Šé™¤